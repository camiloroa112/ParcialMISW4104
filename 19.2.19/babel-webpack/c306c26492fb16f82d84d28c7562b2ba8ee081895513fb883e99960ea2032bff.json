{"ast":null,"code":"import _asyncToGenerator from \"/home/csharp/Documents/ingenieria-de-software-app-web/evaluacion-practica/ParcialMISW4104/vehiculos/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { TestBed } from '@angular/core/testing';\nimport { of } from 'rxjs';\nimport { VehiculosComponente } from './vehiculos.component';\nimport { VehiculoService } from './service/vehiculo-service.service';\nconst mockVehiculos = [{\n  id: 1,\n  marca: 'Renault',\n  linea: 'Kangoo',\n  modelo: 2017\n}, {\n  id: 2,\n  marca: 'Chevrolet',\n  linea: 'Spark',\n  modelo: 2018\n}, {\n  id: 3,\n  marca: 'Nissan',\n  linea: 'March',\n  modelo: 2019\n}];\ndescribe('VehiculosComponente', () => {\n  let fixture;\n  let service;\n  beforeEach(/*#__PURE__*/_asyncToGenerator(function* () {\n    yield TestBed.configureTestingModule({\n      imports: [VehiculosComponente],\n      // standalone component\n      providers: [VehiculoService] // lo inyectamos para poder espiar\n    }).compileComponents();\n    service = TestBed.inject(VehiculoService);\n    fixture = TestBed.createComponent(VehiculosComponente);\n  }));\n  it('debe renderizar una tabla con 3 filas de vehículos más el encabezado', /*#__PURE__*/_asyncToGenerator(function* () {\n    // 1) espía el método ANTES de detectar cambios\n    spyOn(service, 'getVehiculos').and.returnValue(of(mockVehiculos));\n    // 2) primer detectChanges -> dispara el async pipe\n    fixture.detectChanges();\n    // 3) espera a que el async pipe resuelva y Angular pinte\n    yield fixture.whenStable();\n    yield fixture.whenRenderingDone();\n    // 4) segundo detectChanges -> DOM final\n    fixture.detectChanges();\n    // --- queries con nativeElement (más directos) ---\n    const host = fixture.nativeElement;\n    const table = host.querySelector('table');\n    expect(table).not.toBeNull();\n    const bodyRows = host.querySelectorAll('tbody tr');\n    expect(bodyRows.length).toBe(3);\n    const headerCells = host.querySelectorAll('thead tr th');\n    expect(headerCells.length).toBe(4); // #, Marca, Línea, Modelo\n  }));\n});","map":{"version":3,"names":["TestBed","of","VehiculosComponente","VehiculoService","mockVehiculos","id","marca","linea","modelo","describe","fixture","service","beforeEach","_asyncToGenerator","configureTestingModule","imports","providers","compileComponents","inject","createComponent","it","spyOn","and","returnValue","detectChanges","whenStable","whenRenderingDone","host","nativeElement","table","querySelector","expect","not","toBeNull","bodyRows","querySelectorAll","length","toBe","headerCells"],"sources":["/home/csharp/Documents/ingenieria-de-software-app-web/evaluacion-practica/ParcialMISW4104/vehiculos/src/app/vehiculos/vehiculos.component.spec.ts"],"sourcesContent":["import { ComponentFixture, TestBed } from '@angular/core/testing';\nimport { of } from 'rxjs';\nimport { VehiculosComponente } from './vehiculos.component';\nimport { VehiculoService } from './service/vehiculo-service.service';\n\nconst mockVehiculos = [\n  { id: 1, marca: 'Renault', linea: 'Kangoo', modelo: 2017 },\n  { id: 2, marca: 'Chevrolet', linea: 'Spark', modelo: 2018 },\n  { id: 3, marca: 'Nissan', linea: 'March', modelo: 2019 },\n];\n\ndescribe('VehiculosComponente', () => {\n  let fixture: ComponentFixture<VehiculosComponente>;\n  let service: VehiculoService;\n\n  beforeEach(async () => {\n    await TestBed.configureTestingModule({\n      imports: [VehiculosComponente], // standalone component\n      providers: [VehiculoService],   // lo inyectamos para poder espiar\n    }).compileComponents();\n\n    service = TestBed.inject(VehiculoService);\n    fixture = TestBed.createComponent(VehiculosComponente);\n  });\n\n  it('debe renderizar una tabla con 3 filas de vehículos más el encabezado', async () => {\n    // 1) espía el método ANTES de detectar cambios\n    spyOn(service, 'getVehiculos').and.returnValue(of(mockVehiculos));\n\n    // 2) primer detectChanges -> dispara el async pipe\n    fixture.detectChanges();\n\n    // 3) espera a que el async pipe resuelva y Angular pinte\n    await fixture.whenStable();\n    await fixture.whenRenderingDone();\n\n    // 4) segundo detectChanges -> DOM final\n    fixture.detectChanges();\n\n    // --- queries con nativeElement (más directos) ---\n    const host: HTMLElement = fixture.nativeElement as HTMLElement;\n\n    const table = host.querySelector('table');\n    expect(table).not.toBeNull();\n\n    const bodyRows = host.querySelectorAll('tbody tr');\n    expect(bodyRows.length).toBe(3);\n\n    const headerCells = host.querySelectorAll('thead tr th');\n    expect(headerCells.length).toBe(4); // #, Marca, Línea, Modelo\n  });\n});\n"],"mappings":";AAAA,SAA2BA,OAAO,QAAQ,uBAAuB;AACjE,SAASC,EAAE,QAAQ,MAAM;AACzB,SAASC,mBAAmB,QAAQ,uBAAuB;AAC3D,SAASC,eAAe,QAAQ,oCAAoC;AAEpE,MAAMC,aAAa,GAAG,CACpB;EAAEC,EAAE,EAAE,CAAC;EAAEC,KAAK,EAAE,SAAS;EAAEC,KAAK,EAAE,QAAQ;EAAEC,MAAM,EAAE;AAAI,CAAE,EAC1D;EAAEH,EAAE,EAAE,CAAC;EAAEC,KAAK,EAAE,WAAW;EAAEC,KAAK,EAAE,OAAO;EAAEC,MAAM,EAAE;AAAI,CAAE,EAC3D;EAAEH,EAAE,EAAE,CAAC;EAAEC,KAAK,EAAE,QAAQ;EAAEC,KAAK,EAAE,OAAO;EAAEC,MAAM,EAAE;AAAI,CAAE,CACzD;AAEDC,QAAQ,CAAC,qBAAqB,EAAE,MAAK;EACnC,IAAIC,OAA8C;EAClD,IAAIC,OAAwB;EAE5BC,UAAU,cAAAC,iBAAA,CAAC,aAAW;IACpB,MAAMb,OAAO,CAACc,sBAAsB,CAAC;MACnCC,OAAO,EAAE,CAACb,mBAAmB,CAAC;MAAE;MAChCc,SAAS,EAAE,CAACb,eAAe,CAAC,CAAI;KACjC,CAAC,CAACc,iBAAiB,EAAE;IAEtBN,OAAO,GAAGX,OAAO,CAACkB,MAAM,CAACf,eAAe,CAAC;IACzCO,OAAO,GAAGV,OAAO,CAACmB,eAAe,CAACjB,mBAAmB,CAAC;EACxD,CAAC,EAAC;EAEFkB,EAAE,CAAC,sEAAsE,eAAAP,iBAAA,CAAE,aAAW;IACpF;IACAQ,KAAK,CAACV,OAAO,EAAE,cAAc,CAAC,CAACW,GAAG,CAACC,WAAW,CAACtB,EAAE,CAACG,aAAa,CAAC,CAAC;IAEjE;IACAM,OAAO,CAACc,aAAa,EAAE;IAEvB;IACA,MAAMd,OAAO,CAACe,UAAU,EAAE;IAC1B,MAAMf,OAAO,CAACgB,iBAAiB,EAAE;IAEjC;IACAhB,OAAO,CAACc,aAAa,EAAE;IAEvB;IACA,MAAMG,IAAI,GAAgBjB,OAAO,CAACkB,aAA4B;IAE9D,MAAMC,KAAK,GAAGF,IAAI,CAACG,aAAa,CAAC,OAAO,CAAC;IACzCC,MAAM,CAACF,KAAK,CAAC,CAACG,GAAG,CAACC,QAAQ,EAAE;IAE5B,MAAMC,QAAQ,GAAGP,IAAI,CAACQ,gBAAgB,CAAC,UAAU,CAAC;IAClDJ,MAAM,CAACG,QAAQ,CAACE,MAAM,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC;IAE/B,MAAMC,WAAW,GAAGX,IAAI,CAACQ,gBAAgB,CAAC,aAAa,CAAC;IACxDJ,MAAM,CAACO,WAAW,CAACF,MAAM,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;EACtC,CAAC,EAAC;AACJ,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}