{"ast":null,"code":"import _asyncToGenerator from \"/home/csharp/Documents/ingenieria-de-software-app-web/evaluacion-practica/ParcialMISW4104/vehiculos/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { TestBed, waitForAsync } from '@angular/core/testing';\nimport { of } from 'rxjs';\nimport { By } from '@angular/platform-browser';\nimport { VehiculosComponente } from './vehiculos.component';\nimport { VehiculoService } from './service/vehiculo-service.service';\nconst mockVehiculos = [{\n  id: 1,\n  marca: 'Renault',\n  linea: 'Kangoo',\n  modelo: 2017\n}, {\n  id: 2,\n  marca: 'Chevrolet',\n  linea: 'Spark',\n  modelo: 2018\n}, {\n  id: 3,\n  marca: 'Nissan',\n  linea: 'March',\n  modelo: 2019\n}];\ndescribe('VehiculosComponente', () => {\n  let fixture;\n  const vehiculoServiceMock = {\n    getVehiculos: () => of(mockVehiculos)\n  };\n  beforeEach(waitForAsync(/*#__PURE__*/_asyncToGenerator(function* () {\n    yield TestBed.configureTestingModule({\n      imports: [VehiculosComponente],\n      providers: [{\n        provide: VehiculoService,\n        useValue: vehiculoServiceMock\n      }]\n    }).compileComponents();\n  })));\n  beforeEach(() => {\n    fixture = TestBed.createComponent(VehiculosComponente);\n  });\n  it('debe renderizar una tabla con 3 filas de vehículos más el encabezado', waitForAsync(/*#__PURE__*/_asyncToGenerator(function* () {\n    // 1) dispara el async pipe\n    fixture.detectChanges();\n    // 2) espera a que se resuelva la microtarea del async pipe\n    yield fixture.whenStable();\n    // 3) espera a que Angular termine de pintar\n    yield fixture.whenRenderingDone();\n    // 4) nueva detección de cambios para reflejar el DOM final\n    fixture.detectChanges();\n    // (debug opcional)\n    // console.log(fixture.nativeElement.innerHTML);\n    const table = fixture.debugElement.query(By.css('table'));\n    expect(table).toBeTruthy(); // <- ya no debe ser null\n    const bodyRows = fixture.debugElement.queryAll(By.css('tbody tr'));\n    expect(bodyRows.length).toBe(3);\n    const headerCells = fixture.debugElement.queryAll(By.css('thead tr th'));\n    expect(headerCells.length).toBe(4); // #, Marca, Línea, Modelo\n  })));\n});","map":{"version":3,"names":["TestBed","waitForAsync","of","By","VehiculosComponente","VehiculoService","mockVehiculos","id","marca","linea","modelo","describe","fixture","vehiculoServiceMock","getVehiculos","beforeEach","_asyncToGenerator","configureTestingModule","imports","providers","provide","useValue","compileComponents","createComponent","it","detectChanges","whenStable","whenRenderingDone","table","debugElement","query","css","expect","toBeTruthy","bodyRows","queryAll","length","toBe","headerCells"],"sources":["/home/csharp/Documents/ingenieria-de-software-app-web/evaluacion-practica/ParcialMISW4104/vehiculos/src/app/vehiculos/vehiculos.component.spec.ts"],"sourcesContent":["import { ComponentFixture, TestBed, waitForAsync } from '@angular/core/testing';\nimport { of } from 'rxjs';\nimport { By } from '@angular/platform-browser';\nimport { VehiculosComponente } from './vehiculos.component';\nimport { VehiculoService } from './service/vehiculo-service.service';\n\nconst mockVehiculos = [\n  { id: 1, marca: 'Renault', linea: 'Kangoo', modelo: 2017 },\n  { id: 2, marca: 'Chevrolet', linea: 'Spark', modelo: 2018 },\n  { id: 3, marca: 'Nissan', linea: 'March', modelo: 2019 },\n];\n\ndescribe('VehiculosComponente', () => {\n  let fixture: ComponentFixture<VehiculosComponente>;\n\n  const vehiculoServiceMock = {\n    getVehiculos: () => of(mockVehiculos),\n  };\n\n  beforeEach(waitForAsync(async () => {\n    await TestBed.configureTestingModule({\n      imports: [VehiculosComponente],\n      providers: [{ provide: VehiculoService, useValue: vehiculoServiceMock }],\n    }).compileComponents();\n  }));\n\n  beforeEach(() => {\n    fixture = TestBed.createComponent(VehiculosComponente);\n  });\n\n  it('debe renderizar una tabla con 3 filas de vehículos más el encabezado', waitForAsync(async () => {\n    // 1) dispara el async pipe\n    fixture.detectChanges();\n\n    // 2) espera a que se resuelva la microtarea del async pipe\n    await fixture.whenStable();\n\n    // 3) espera a que Angular termine de pintar\n    await fixture.whenRenderingDone();\n\n    // 4) nueva detección de cambios para reflejar el DOM final\n    fixture.detectChanges();\n\n    // (debug opcional)\n    // console.log(fixture.nativeElement.innerHTML);\n\n    const table = fixture.debugElement.query(By.css('table'));\n    expect(table).toBeTruthy(); // <- ya no debe ser null\n\n    const bodyRows = fixture.debugElement.queryAll(By.css('tbody tr'));\n    expect(bodyRows.length).toBe(3);\n\n    const headerCells = fixture.debugElement.queryAll(By.css('thead tr th'));\n    expect(headerCells.length).toBe(4); // #, Marca, Línea, Modelo\n  }));\n});\n"],"mappings":";AAAA,SAA2BA,OAAO,EAAEC,YAAY,QAAQ,uBAAuB;AAC/E,SAASC,EAAE,QAAQ,MAAM;AACzB,SAASC,EAAE,QAAQ,2BAA2B;AAC9C,SAASC,mBAAmB,QAAQ,uBAAuB;AAC3D,SAASC,eAAe,QAAQ,oCAAoC;AAEpE,MAAMC,aAAa,GAAG,CACpB;EAAEC,EAAE,EAAE,CAAC;EAAEC,KAAK,EAAE,SAAS;EAAEC,KAAK,EAAE,QAAQ;EAAEC,MAAM,EAAE;AAAI,CAAE,EAC1D;EAAEH,EAAE,EAAE,CAAC;EAAEC,KAAK,EAAE,WAAW;EAAEC,KAAK,EAAE,OAAO;EAAEC,MAAM,EAAE;AAAI,CAAE,EAC3D;EAAEH,EAAE,EAAE,CAAC;EAAEC,KAAK,EAAE,QAAQ;EAAEC,KAAK,EAAE,OAAO;EAAEC,MAAM,EAAE;AAAI,CAAE,CACzD;AAEDC,QAAQ,CAAC,qBAAqB,EAAE,MAAK;EACnC,IAAIC,OAA8C;EAElD,MAAMC,mBAAmB,GAAG;IAC1BC,YAAY,EAAEA,CAAA,KAAMZ,EAAE,CAACI,aAAa;GACrC;EAEDS,UAAU,CAACd,YAAY,cAAAe,iBAAA,CAAC,aAAW;IACjC,MAAMhB,OAAO,CAACiB,sBAAsB,CAAC;MACnCC,OAAO,EAAE,CAACd,mBAAmB,CAAC;MAC9Be,SAAS,EAAE,CAAC;QAAEC,OAAO,EAAEf,eAAe;QAAEgB,QAAQ,EAAER;MAAmB,CAAE;KACxE,CAAC,CAACS,iBAAiB,EAAE;EACxB,CAAC,EAAC,CAAC;EAEHP,UAAU,CAAC,MAAK;IACdH,OAAO,GAAGZ,OAAO,CAACuB,eAAe,CAACnB,mBAAmB,CAAC;EACxD,CAAC,CAAC;EAEFoB,EAAE,CAAC,sEAAsE,EAAEvB,YAAY,cAAAe,iBAAA,CAAC,aAAW;IACjG;IACAJ,OAAO,CAACa,aAAa,EAAE;IAEvB;IACA,MAAMb,OAAO,CAACc,UAAU,EAAE;IAE1B;IACA,MAAMd,OAAO,CAACe,iBAAiB,EAAE;IAEjC;IACAf,OAAO,CAACa,aAAa,EAAE;IAEvB;IACA;IAEA,MAAMG,KAAK,GAAGhB,OAAO,CAACiB,YAAY,CAACC,KAAK,CAAC3B,EAAE,CAAC4B,GAAG,CAAC,OAAO,CAAC,CAAC;IACzDC,MAAM,CAACJ,KAAK,CAAC,CAACK,UAAU,EAAE,CAAC,CAAC;IAE5B,MAAMC,QAAQ,GAAGtB,OAAO,CAACiB,YAAY,CAACM,QAAQ,CAAChC,EAAE,CAAC4B,GAAG,CAAC,UAAU,CAAC,CAAC;IAClEC,MAAM,CAACE,QAAQ,CAACE,MAAM,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC;IAE/B,MAAMC,WAAW,GAAG1B,OAAO,CAACiB,YAAY,CAACM,QAAQ,CAAChC,EAAE,CAAC4B,GAAG,CAAC,aAAa,CAAC,CAAC;IACxEC,MAAM,CAACM,WAAW,CAACF,MAAM,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;EACtC,CAAC,EAAC,CAAC;AACL,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}